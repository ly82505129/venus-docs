(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{333:function(t,s,e){t.exports=e.p+"assets/img/venus-cluster.39d38e43.png"},425:function(t,s,e){"use strict";e.r(s);var a=e(54),n=Object(a.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"background"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#background"}},[t._v("#")]),t._v(" Background")]),t._v(" "),a("p",[t._v("Starting filecoin mining could be a daunting task given not only the large initial hardware and filecoin collateral "),a("a",{attrs:{href:"https://filscan.io/calculator",target:"_blank",rel:"noopener noreferrer"}},[t._v("investment"),a("OutboundLink")],1),t._v(" but also the entailing operation commitment. With ideas of security, ease of use and distributed mining pool in mind, Venus implementation of filecoin will help miners turn, what community say, "),a("a",{attrs:{href:"https://filecoinproject.slack.com/archives/CEGN061C5/p1610810730117900?thread_ts=1610809298.116800&cid=CEGN061C5",target:"_blank",rel:"noopener noreferrer"}},[t._v("a full time job"),a("OutboundLink")],1),t._v(" into a serious hobby. Hope this tutorial will get you started mining in no time!")]),t._v(" "),a("h2",{attrs:{id:"how-mining-works"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#how-mining-works"}},[t._v("#")]),t._v(" How mining works")]),t._v(" "),a("p",[t._v("There are two ways of getting started with mining using Venus.")]),t._v(" "),a("ol",[a("li",[t._v("Deploy minimum hardware and gain access to a publicly hosted shared venus modules."),t._v(" (See "),a("RouterLink",{attrs:{to:"/guide/Using-venus-Shared-Modules.html"}},[t._v("this")]),t._v(" tutorial to learn more)")],1),t._v(" "),a("li",[t._v("Deploy all required hardware and venus modules by yourself. (The rest of this tutorial will walk you through this way of deploying venus mining operation)")])]),t._v(" "),a("p",[t._v("After following the rest of the trutorial and successful deployment, you can start pledging sectors, grow power and evantually obtain block rewards through your contribution to the network's storage capacity!")]),t._v(" "),a("h2",{attrs:{id:"introducing-venus-modules"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#introducing-venus-modules"}},[t._v("#")]),t._v(" Introducing venus modules")]),t._v(" "),a("p",[t._v("Depending on its role in a mining cluster, modules could be loosely broken down into two category: shared and independent. Shared modules could be thought as the plumbings of what you need to start sealing sectors. Most of the dealings with the blockchain like chain synchronizations, sending messages, winning a block and etc are handled by the shared modules. The idea is that many miners could all use a set of shared modules, thus reducing overhead in maintainence. Independent modules handles sealing and proving of your sectors, where you will be spend most of your time if you choose to use a publicly hosted shared venus modules. Note also that venus-wallet module could be deployed as either shared or independent.")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("name")]),t._v(" "),a("th",[t._v("role")]),t._v(" "),a("th",[t._v("shared/independent")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[a("a",{attrs:{href:"https://github.com/filecoin-project/venus",target:"_blank",rel:"noopener noreferrer"}},[t._v("venus"),a("OutboundLink")],1)]),t._v(" "),a("td",[t._v("daemon for chain interactions")]),t._v(" "),a("td",[t._v("shared")])]),t._v(" "),a("tr",[a("td",[a("a",{attrs:{href:"https://github.com/filecoin-project/venus-miner",target:"_blank",rel:"noopener noreferrer"}},[t._v("venus-miner"),a("OutboundLink")],1)]),t._v(" "),a("td",[t._v("block winning and proving")]),t._v(" "),a("td",[t._v("shared")])]),t._v(" "),a("tr",[a("td",[a("a",{attrs:{href:"https://github.com/filecoin-project/venus-messager",target:"_blank",rel:"noopener noreferrer"}},[t._v("venus-messager"),a("OutboundLink")],1)]),t._v(" "),a("td",[t._v("chain message management")]),t._v(" "),a("td",[t._v("shared")])]),t._v(" "),a("tr",[a("td",[a("a",{attrs:{href:"https://github.com/filecoin-project/venus-auth",target:"_blank",rel:"noopener noreferrer"}},[t._v("venus-auth"),a("OutboundLink")],1)]),t._v(" "),a("td",[t._v("utility for authorized use of shared modules")]),t._v(" "),a("td",[t._v("shared")])]),t._v(" "),a("tr",[a("td",[a("a",{attrs:{href:"https://github.com/ipfs-force-community/venus-gateway",target:"_blank",rel:"noopener noreferrer"}},[t._v("venus-gateway"),a("OutboundLink")],1)]),t._v(" "),a("td",[t._v("utility for controlled access point of shared modules")]),t._v(" "),a("td",[t._v("shared")])]),t._v(" "),a("tr",[a("td",[a("a",{attrs:{href:"https://github.com/filecoin-project/venus-wallet",target:"_blank",rel:"noopener noreferrer"}},[t._v("venus-wallet"),a("OutboundLink")],1)]),t._v(" "),a("td",[t._v("addresses/keys management")]),t._v(" "),a("td",[t._v("shared/independent")])]),t._v(" "),a("tr",[a("td",[a("a",{attrs:{href:"https://github.com/filecoin-project/venus-sealer",target:"_blank",rel:"noopener noreferrer"}},[t._v("venus-sealer"),a("OutboundLink")],1),t._v(", "),a("a",{attrs:{href:"https://github.com/filecoin-project/venus-sealer",target:"_blank",rel:"noopener noreferrer"}},[t._v("venus-worker"),a("OutboundLink")],1)]),t._v(" "),a("td",[t._v("job scheduling, sealing and proving")]),t._v(" "),a("td",[t._v("independent")])]),t._v(" "),a("tr",[a("td",[a("a",{attrs:{href:"https://github.com/filecoin-project/venus-market",target:"_blank",rel:"noopener noreferrer"}},[t._v("venus-market"),a("OutboundLink")],1)]),t._v(" "),a("td",[t._v("deal making")]),t._v(" "),a("td",[t._v("independent")])])])]),t._v(" "),a("h2",{attrs:{id:"mining-architecture"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mining-architecture"}},[t._v("#")]),t._v(" Mining architecture")]),t._v(" "),a("p",[t._v("Diagram below illustrates how venus modules interacts with one and another.")]),t._v(" "),a("p",[a("img",{attrs:{src:e(333),alt:"venus-cluster"}})]),t._v(" "),a("h2",{attrs:{id:"hardware-requirements"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#hardware-requirements"}},[t._v("#")]),t._v(" Hardware requirements")]),t._v(" "),a("p",[t._v("Learn more about hardware requirements "),a("a",{attrs:{href:"https://docs.filecoin.io/mine/mining-architectures/#protocol-labs-example-architecture",target:"_blank",rel:"noopener noreferrer"}},[t._v("here"),a("OutboundLink")],1),t._v(".")]),t._v(" "),a("h2",{attrs:{id:"pre-requisites"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#pre-requisites"}},[t._v("#")]),t._v(" Pre-requisites")]),t._v(" "),a("p",[t._v("Before diving into deployment of your mining operation, please make sure you go through the following steps.")]),t._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[t._v("WARNING")]),t._v(" "),a("p",[t._v("It is recommended that you test your setup in nerpa or calibration network before deploying on mainnet.")])]),t._v(" "),a("h3",{attrs:{id:"setup-your-permanent-storage"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#setup-your-permanent-storage"}},[t._v("#")]),t._v(" Setup your permanent storage")]),t._v(" "),a("p",[t._v("Choose a network file system that you are familiar with (NFS for example) and deploy your storage cluster.")]),t._v(" "),a("h3",{attrs:{id:"software-dependencies"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#software-dependencies"}},[t._v("#")]),t._v(" Software dependencies")]),t._v(" "),a("p",[t._v("You will need the following software installed before running venus.")]),t._v(" "),a("h4",{attrs:{id:"build-tools"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#build-tools"}},[t._v("#")]),t._v(" Build tools")]),t._v(" "),a("p",[t._v("Ubuntu/Debian:")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" mesa-opencl-icd ocl-icd-opencl-dev gcc "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" bzr jq pkg-config "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" clang build-essential hwloc libhwloc-dev "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("wget")]),t._v(" -y "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt")]),t._v(" upgrade -y\n")])])]),a("p",[t._v("CentOS:")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" yum "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" -y https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" yum "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" -y "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" gcc bzr jq pkgconfig clang llvm mesa-libGL-devel opencl-headers ocl-icd ocl-icd-devel hwloc-devel\n")])])]),a("h4",{attrs:{id:"go"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#go"}},[t._v("#")]),t._v(" Go")]),t._v(" "),a("p",[t._v("To build venus, you need a working installation of "),a("a",{attrs:{href:"https://golang.org/dl/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Go 1.16 or higher"),a("OutboundLink")],1),t._v(".")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("wget")]),t._v(" -c https://golang.org/dl/go1.16.2.linux-amd64.tar.gz -O - "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("tar")]),t._v(" -xz -C /usr/local\n")])])]),a("p",[t._v("Add "),a("code",[t._v("/usr/local/go/bin")]),t._v(" to your path and setup "),a("code",[t._v("Go")]),t._v(" env. For most Linux distributions you can run something like:")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"export PATH='),a("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("$PATH")]),t._v(':/usr/local/go/bin"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),t._v(" ~/.bashrc "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("source")]),t._v(" ~/.bashrc\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# setup go env")]),t._v("\ngo "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("env")]),t._v(" -w "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("GOPROXY")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("https://goproxy.io,direct\ngo "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("env")]),t._v(" -w "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("GO111MODULE")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("on\n")])])]),a("p",[t._v("See the "),a("a",{attrs:{href:"https://golang.org/doc/install",target:"_blank",rel:"noopener noreferrer"}},[t._v("official Golang installation instructions"),a("OutboundLink")],1),t._v(" if you get stuck.")]),t._v(" "),a("h2",{attrs:{id:"install-venus-auth"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#install-venus-auth"}},[t._v("#")]),t._v(" Install venus-auth")]),t._v(" "),a("p",[t._v("Download and compile the source code of venus-auth.")]),t._v(" "),a("div",{staticClass:"language-shell script extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" clone https://github.com/filecoin-project/venus-auth.git\n$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" venus-auth\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" checkout "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("RELEASE_TAG"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v(" \n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("nohup")]),t._v(" ./venus-auth run "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" auth.log "),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("2")]),t._v(">")]),a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("&1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("\n")])])]),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),a("p",[t._v("Default config file for Venus-auth is located at "),a("code",[t._v("~/.venus-auth/config.toml")]),t._v(".")])]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("Logs")]),t._v(" "),a("p",[t._v("Log defaults printing to console. InfluxDB is supported through configuration.")])]),t._v(" "),a("h3",{attrs:{id:"using-mysql-optional"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#using-mysql-optional"}},[t._v("#")]),t._v(" Using MySQL (Optional)")]),t._v(" "),a("p",[t._v("MySQL 5.7 or above is supported and can be used as a substitute for the dedault Badger key-value  database. To use MySQL database, modify the db section of the config.")]),t._v(" "),a("div",{staticClass:"language-shell script extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("vim")]),t._v(" ~/.venus-auth/config.toml\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Data source configuration item")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("db"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# support: badger (default), mysql ")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# the mysql DDL is in the script package ")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("type")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mysql"')]),t._v(" \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# The following parameters apply to MySQL")]),t._v("\nDSN "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"<USER>:<PASSWORD>@(127.0.0.1:3306)/venus_auth?parseTime=true&loc=Local&charset=utf8mb4&collation=utf8mb4_unicode_ci&readTimeout=10s&writeTimeout=10s"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# conns 1500 concurrent")]),t._v("\nmaxOpenConns "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("64")]),t._v("\nmaxIdleConns "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("128")]),t._v("\nmaxLifeTime "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"120s"')]),t._v("\nmaxIdleTime "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"30s"')]),t._v("\n")])])]),a("p",[t._v("Restart venus-auth for the configuration to take into effect.")]),t._v(" "),a("div",{staticClass:"language-shell script extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ps")]),t._v(" -ef "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("grep")]),t._v(" auth\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("kill")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("VENUS_AUTH_PID"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("nohup")]),t._v(" ./venus-auth run "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" auth.log "),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("2")]),t._v(">")]),a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("&1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("\n")])])]),a("h3",{attrs:{id:"token-gerneration"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#token-gerneration"}},[t._v("#")]),t._v(" Token gerneration")]),t._v(" "),a("p",[t._v("venus-auth manages "),a("a",{attrs:{href:"https://jwt.io/",target:"_blank",rel:"noopener noreferrer"}},[t._v("jwt"),a("OutboundLink")],1),t._v(" tokens used by other venus modules for them to talk to each other securely on the network.")]),t._v(" "),a("p",[t._v("Generate tokens for shared modules.")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# --perm specifies admin, sign, wirte or read permission of the token generated")]),t._v("\n$ ./venus-auth token gen --perm admin "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("SHARED"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("SHARED_ADMIN_AUTH_TOKEN"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])]),a("p",[t._v("Generate tokens for independent modules. Tokens can be logically grouped by "),a("code",[t._v("<USER>")]),t._v(" as individual miner joining the mining pool.")]),t._v(" "),a("div",{staticClass:"language-shell script extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("$ ./venus-auth user "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),t._v(" --name "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("USER")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" --miner"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("minerID"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n$ ./venus-auth token gen --perm "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("write")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("USER")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("USER_WRITE_AUTH_TOKEN"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n$ ./venus-auth token gen --perm "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("read")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("USER")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("USER_READ_AUTH_TOKEN"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])]),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),a("p",[t._v("Use "),a("code",[t._v("./venus-auth user add <USER>")]),t._v(" to logically group different tokens. If there is already a miner number, bring --miner, if not, you need to update after the miner is created:")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("$ ./venus-auth user update --name <USER> --miner=<minerID>\n\n# 查看user列表\n$ ./venus-auth user list\n")])])])]),t._v(" "),a("h2",{attrs:{id:"install-venus-gateway"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#install-venus-gateway"}},[t._v("#")]),t._v(" Install venus-gateway")]),t._v(" "),a("p",[t._v("Download and compile the source code of venus-gateway.")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" clone https://github.com/filecoin-project/venus-gateway.git\n$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" venus-gateway\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" checkout "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("RELEASE_TAG"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n$ go mod tidy\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v("\n")])])]),a("p",[t._v("Start venus-gateway.")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ ./venus-gateway --listen"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/ip4/0.0.0.0/tcp/45132 run "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Use either a http or https url")]),t._v("\n--auth-url"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("http://VENUS_AUTH_IP_ADDRESS:PORT"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" venus-gateway.log "),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("2")]),t._v(">")]),a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("&1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("\n")])])]),a("blockquote",[a("p",[t._v("If you encounter the following compilation errors, execute first"),a("code",[t._v("go get github.com/google/flatbuffers@v1.12.1")])])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("github.com/dgraph-io/badger/v3@v3.2011.1/fb/BlockOffset.go:6:2: missing go.sum entry "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" module providing package github.com/google/flatbuffers/go "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("imported by github.com/dgraph-io/badger/v3/table"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" to add:\n        go get github.com/dgraph-io/badger/v3/table@v3.2011.1\n")])])]),a("h2",{attrs:{id:"install-venus-daemon"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#install-venus-daemon"}},[t._v("#")]),t._v(" Install venus daemon")]),t._v(" "),a("p",[t._v("Download and compile the source code of venus.")]),t._v(" "),a("div",{staticClass:"language-shell script extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" clone https://github.com/filecoin-project/venus.git\n$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" venus\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" checkout "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("RELEASE_TAG"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v(" deps\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v("\n")])])]),a("p",[t._v("Start venus daemon for chain synchronization. Use "),a("code",[t._v("--network")]),t._v(" to specify the network venus is connecting to.")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("nohup")]),t._v(" ./venus daemon --network"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("nerpa --auth-url"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("http://VENUS_AUTH_IP_ADDRESS:PORT"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" venus.log "),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("2")]),t._v(">")]),a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("&1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" \n")])])]),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),a("p",[t._v("Use "),a("code",[t._v("tail -f venus.log")]),t._v("  or "),a("code",[t._v("./venus sync status")]),t._v(" to check if there is any errors during sychronization.")])]),t._v(" "),a("h3",{attrs:{id:"grant-access-to-venus-daemon"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#grant-access-to-venus-daemon"}},[t._v("#")]),t._v(" Grant access to venus daemon")]),t._v(" "),a("p",[t._v("By default, venus daemon only respond to local access. Change the following configuration to allow access from other addresses.")]),t._v(" "),a("div",{staticClass:"language-shell script extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("vim")]),t._v(" ~/.venus/config.json\n")])])]),a("p",[t._v("Change "),a("code",[t._v("apiAddress")]),t._v(" from "),a("code",[t._v("/ip4/127.0.0.1/tcp/3453")]),t._v(" to "),a("code",[t._v("/ip4/0.0.0.0/tcp/3453")]),t._v(". Save and close the config file.")]),t._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"api"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"apiAddress"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/ip4/0.0.0.0/tcp/3453"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("Restart venus daemon for the config to take into effects.")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ps")]),t._v(" -ef "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("grep")]),t._v(" venus\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("kill")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("VENUS_PID"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("nohup")]),t._v(" ./venus daemon --network"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("nerpa --auth-url "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("http://VENUS_AUTH_IP_ADDRESS:PORT"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" venus.log "),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("2")]),t._v(">")]),a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("&1")]),t._v(" \n")])])]),a("h2",{attrs:{id:"install-venus-messager"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#install-venus-messager"}},[t._v("#")]),t._v(" Install venus-messager")]),t._v(" "),a("p",[t._v("Download and compile the source code of venus-messager.")]),t._v(" "),a("div",{staticClass:"language-shell script extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" clone https://github.com/filecoin-project/venus-messager.git\n$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" venus-messager\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" checkout "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("RELEASE_TAG"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v(" \n")])])]),a("p",[t._v("Start venus-messager. Note that "),a("code",[t._v("--auth-url")]),t._v(", "),a("code",[t._v("--node-url")]),t._v(" and "),a("code",[t._v("--auth-token")]),t._v(" are for venus-messager to be aware of other venus modules and be properly authenticated.")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("nohup")]),t._v(" ./venus-messager run "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--auth-url"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("http://VENUS_AUTH_IP_ADDRESS:PORT"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--node-url /ip4/"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("VENUS_DAEMON_IP_ADDRESS"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("/tcp/3453 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--gateway-url"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/ip4/"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("IP_ADDRESS_OF_VENUS_GATEWAY"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("/tcp/45132 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--auth-token "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("SHARED_ADMIN_AUTH_TOKEN"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--db-type mysql "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--mysql-dsn "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"<USER>:<PASSWORD>@(127.0.0.1:3306)/venus_messager?parseTime=true&loc=Local&readTimeout=10s&writeTimeout=10s"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" msg.log "),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("2")]),t._v(">")]),a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("&1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("\n")])])]),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),a("p",[t._v("If no database related params are specified, venus-messager will default to use sqlite.")])]),t._v(" "),a("h2",{attrs:{id:"install-venus-miner"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#install-venus-miner"}},[t._v("#")]),t._v(" Install venus-miner")]),t._v(" "),a("p",[t._v("Download and compile the source code of venus-miner.")]),t._v(" "),a("div",{staticClass:"language-shell script extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" clone https://github.com/filecoin-project/venus-miner.git\n$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" venus-miner\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" checkout "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("RELEASE_TAG"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v("\n")])])]),a("p",[t._v("Initialize venus-miner.")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ ./venus-miner init\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# For nettype, choose from mainnet, nerpanet, debug, 2k, calibnet")]),t._v("\n--nettype nerpanet\n--auth-api "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("http://VENUS_AUTH_IP_ADDRESS:PORT"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--token "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("SHARED_ADMIN_AUTH_TOKEN"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--gateway-api /ip4/"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("VENUS_GATEWAY_IP_ADDRESS"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("/tcp/45132\n--api /ip4/"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("VENUS_DAEMON_IP_ADDRESS"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("/tcp/3453 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n")])])]),a("p",[t._v("Run venus-miner.")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("nohup")]),t._v(" ./venus-miner run "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),t._v("miner.log "),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("2")]),t._v(">&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("\n")])])]),a("h3",{attrs:{id:"miner-management"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#miner-management"}},[t._v("#")]),t._v(" Miner management")]),t._v(" "),a("p",[t._v("Once a user, venus-sealer with proper miner id, connected to your shared modules. You can query the status of said miner id by the following.")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ ./venus-miner address state \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Addr"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"<MINER_ID>"')]),t._v(",\n\t\t"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"IsMining"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" true,\n\t\t"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Err"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" null\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),a("p",[t._v("If "),a("code",[t._v("IsMining")]),t._v(" of your miner is "),a("code",[t._v("false")]),t._v(", you can run the following command to start the miner id.")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ ./venus-miner address start "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("MINER_ID"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])]),a("p",[t._v("List all miner ids that have connected to venus-miner.")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ ./venus-miner address list\n")])])]),a("h2",{attrs:{id:"next-steps"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#next-steps"}},[t._v("#")]),t._v(" Next steps")]),t._v(" "),a("p",[t._v("Next, please follow this "),a("RouterLink",{attrs:{to:"/guide/Using-venus-Shared-Modules.html"}},[t._v("guide")]),t._v(" to connect to the storage pool you just deployed!")],1),t._v(" "),a("h2",{attrs:{id:"questions"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#questions"}},[t._v("#")]),t._v(" Questions？")]),t._v(" "),a("p",[t._v("Find us on "),a("a",{attrs:{href:"https://filecoinproject.slack.com/archives/CEHHJNJS3",target:"_blank",rel:"noopener noreferrer"}},[t._v("Slack"),a("OutboundLink")],1),t._v("!")])])}),[],!1,null,null,null);s.default=n.exports}}]);